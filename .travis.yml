language: ruby
services:
  - docker
before_install:
  - cd script
  - docker-compose build
  - docker-compose up -d
  - docker ps
before_script:
  - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
  - chmod +x ./cc-test-reporter
  - ./cc-test-reporter before-build
script:
  - "./test.sh"
after_script:
  - ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT"
env:
  global:
    secure: qbhS98biwrQRcLXTTMZjVbCn3NyNR0MtGrAvTj4H+QQNbDMjLS2TXD1Fjd6iUrvjSyKPThsxafZFRWF56WXxkPhpL2VIO3fM1o4BoWR5uVprq2uCSz3qqFvoFF1/JWLKXTtiNHSv6xfgocPOClWVPOZ0sfH2Q2RnlyOuNFSu7EXVFFUD8FK0+S8BbuwDr8VK7Hs/TGlf8yS8tmVa+f2LNzxS1Se4PLrsyr2q9fhlMMEq37otJJ53fuOmb6pSA4kbn0o64UXN5Oqo56PoaVszHpe8zqwsnbrKHijbEcEF4CDamr78OM5HIET6ACWbPOseyf2cleuAXMc7ofqHYBkJ/ZITU544016vnnSNRMqa1hQ5iBCBe3bZElA0A56rWU5X4Cvx9MmAD8arX1Ai5cY9ANLEL+KSNsaG08TioaV8t31yFEPVILW7hFX+kcodx1WSUIbwOXDdR1+oc3fwGKKS8ItPwlntvOGc7U+0JzvsTPIJzRqpT/cNx+wV33KkndzmOObEjtURjwGJbnYQqz1lv25IWDiALDe/ozDX7rgsSWTsQev754JBac3wU0jyUrhao4QLTNWEwHHVbMsxnnceWnKz/AHQS0bl4VOgf0y8mEQWLS+fGGm0SwB7I4gls8ehgOxTGXtXtWdeNOKsVLBFPq0ZPd0nKjDJDj6RebgM7Fc=
deploy:
  provider: rubygems
  api_key:
    secure: FYZP52Y2n2JR8YJ2YdFpnJ8/0KVAa4yfpH7580VZFSRYiDZQ17teaFbVhhB5tlrODweo6eXYNQLyvhZnifEpw7zP/0lcGrc7wLrbRxmYPgMO8520W2HxPpp4nFu+y/LgVB/bOL2VOtuiCnG0ps/iuNiNdc76jvie1dZzkknfuoAM2RmUJasgFEVtlrDBypsSF0cCtDQiw0NpkrcHdrndGFdSuqEWHgWGmSpQmlJ+3u8bEWwB+AtNf5k6CsOrNilY1T8VAGnh+bk5P9+ngysjIBWR71pWdVQ1wieEFJyeVf5dBmG9HyOdsjcWZYiVtokcemNP+Spr6NX/ZdMEMUcu9/gv6IyvgPYjGrx4r+zH3A1o4G5wPCMbN5CDrCYybpsW9KZE7/FKhdCDHnKf8ajk6QgzW8cd0abup/O/Nj172vxY059Py2h8Jn8OvlnE2/aG+42poNQaLHO1t04/8VwnDkAnFQD2nU5Fvsr3OEKKdzCviXMk3W9xAxdg4lYTHLIdDRoqRMsors4ZwgJhyPEFlBzJ4RrkRkSLWMDbnLaIErl8KKz1LdjDs08tV322ZUyY+UN8XZwpAR+YC6MyswFI4EyTNtGvFDrcm/YoB7wJG0Rjl3cmEjUl/DZVAYVr3btOSL/Nm/C1TK852Lda/ors/HHA8DeaRDw7GjH3odXQxxQ=
  gem: eventq
  on:
    tags: true
    repo: Sage/eventq
    condition: $TRAVIS_TAG =~ ^v(\d+\.){2,}\d+(.rc\d+)?$
